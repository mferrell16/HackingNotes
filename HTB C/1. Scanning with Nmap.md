Default -sS The TCP-SYN scan sends one packet with the SYN flag and, therefore, never completes the three-way handshake, which results in not establishing a full TCP connection to the scanned port.
```shell-session
sudo nmap -sS localhost
```

Ping sweep network range and only return IPs 
```shell-session
sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5
``` 

![[Screenshot 2025-03-12 at 11.14.24 PM.png]]

Tracing the packets 
```shell-session
sudo nmap 10.129.2.28 -p 21 --packet-trace -Pn -n --disable-arp-ping
``` 

-sT The `Connect` scan (also known as a full TCP connect scan) is highly accurate because it completes the three-way TCP handshake, allowing us to determine the exact state of a port (open, closed, or filtered). However, it is not the most stealthy. In fact, the Connect scan is one of the least stealthy techniques 
```shell-session
sudo nmap 10.129.2.28 -p 443 -sT 
```

UDP scan -sU 
```shell-session
sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 137 --reason 
```


Nmap's TCP ACK scan (`-sA`) method is much harder to filter for firewalls and IDS/IPS systems than regular SYN (`-sS`) or Connect scans (`sT`) because they only send a TCP packet with only the `ACK` flag. When a port is closed or open, the host must respond with an `RST` flag. Unlike outgoing connections, all connection attempts (with the `SYN` flag) from external networks are usually blocked by firewalls. However, the packets with the `ACK` flag are often passed by the firewall because the firewall cannot determine whether the connection was first established from the external network or the internal network.

```shell-session
sudo nmap 10.129.2.28 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace
```


Firewall Evasion techniques. 
>Scan by Using Decoys  
  
```
sudo nmap 10.129.2.47 -p 22,80,50000 -sV -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53 -e tun0 -D RND:10
```  

>Connect To The Filtered Port `50000` discovered, from a different source port of `53` to evade detection.

```
ncat -nv --source-port 53 10.129.2.47 50000
```  

>Additional techniques by targeting [Firewall and IDS/IPS Evasion](https://academy.hackthebox.com/module/19/section/106)  

>Testing Firewall Rule  

```
sudo nmap 10.129.2.28 -n -Pn -p445 -O
```

>Scan by Using Different Source IP  

```
sudo nmap 10.129.2.28 -n -Pn -p 445 -O -S 10.129.2.200 -e tun0
```  

>SYN-Scan From DNS Port  

```
sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53
```